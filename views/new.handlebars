<div class='container inter-tight-regular'>
    <h2>Add Animal</h2>
    <form id='add-animal-form' action='/animal' method='POST'>
        <div>
            <div class='form-group-1'>
                <label for='name'>Name:</label>
                <input type='text' id='animal-name' name='name' required>

                <label for='chip'>Microchip:</label>
                <input type='text' id='animal-chip' name='chip'>
            </div>

            <div class='columns'>
                <div class='form-group-2'>
                    <div class='drop-list'>
                        <label for='species'>Species: </label>
                            <select name='species'>
                            <option value = "1">dog</option>
                            <option value = "2">cat</option>
                        </select>
                    </div>

                    <div class='drop-list'>
                        <label for='breed'>Breed:</label>
                        <select name='breed'>
                            <option value = "1">bulldog</option>
                            <option value = "2">calico</option>
                            <option value = "3">tabby</option>
                            <option value = "4">dachschund</option>
                            <option value = "5">Siamese</option>
                            <option value = "6">retriever</option>
                        </select>
                    </div>

                    <div class='radio-check-group'>
                        <label for='sex'>Sex:</label>
                        <div class='radio-list'>
                            <input type='radio' id='female' name='sex' value='F' checked />
                            <label for='female'>female</label>
                        </div>
                        <div class='radio-list'>
                            <input type='radio' id='male' name='sex' value='M' />
                            <label for='radio'>male</label>
                        </div>
                    </div>

                    <div class='radio-check-group'>
                        <label for='altered-yes'>Altered:</label>
                        <div class='radio-list'>
                            <input type='radio' id='animal-altered-yes' name='altered' value='yes' checked />
                            <label for='yes'>yes</label>
                        </div>
                        <div class='radio-list'>
                            <input type='radio' id='animal-altered-no' name='altered' value='no' />
                            <label for='radio'>no</label>
                        </div>
                    </div>
                </div>
                    
                <div class='form-group-3'>
                    <div class='drop-list'>
                        <label for='color'>Color:</label>
                        <select name='color'>
                            <option value="1">black</option>
                            <option value="2">white</option>
                            <option value="3">gray</option>
                            <option value="4">brown</option>
                            <option value="5">yellow</option>
                            <option value="6">orange</option>
                            <option value="7">brindle</option>
                        </select>
                    </div>

                    <div class='radio-check-group'>
                        <label for='behavior'>Behavior Issues:</label>
                        <div class='checkbox-list'>
                            <input type='checkbox' id='toy-aggression' name='behavior'/>
                            <label for='toy-aggression'>toy aggression</label></br>
                            <input type='checkbox' id='animal-aggression' name='behavior'/>
                            <label for='aggression'>animal aggression</label></br>
                            <input type='checkbox' id='not-housebroken' name='behavior'/>
                            <label for='not-housebroken'>not housebroken</label>
                        </div>

                        <div>
                            <label for='kennel'>Kennel:</label>
                            <input type='text' id='kennel' name='kennel' placeholder='e.g., A5'>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button type='submit' id='save-button'>Save</button>
        <button type='button' id='cancel-button'>Cancel</button>
    </form>
</div>
<script>

document.addEventListener("DOMContentLoaded", function() {
    const form = document.getElementById('add-animal-form');
    const saveButton = document.getElementById('save-button');
    const cancelButton = document.getElementById('cancel-button');

    // Handle Save button click
    form.addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent default form submission

        const formData = new FormData(form); 
        const formObject = Object.fromEntries(formData.entries())
        console.log(formObject)
        fetch('/api/animals/animal', {
    method: 'POST',
    body: JSON.stringify({
        name: formObject.name,
        sex: formObject.sex,
        altered: formObject.altered,
        chip: formObject.chip,
        species_id: formObject.species,
        breed_id: formObject.breed,
        color_id: formObject.color,
        kennel_id: 1,
        behavior_id: formObject.behavior
    }),
        headers: {
        "Content-Type": "application/json",
    },

})
.then(response => {
    if (!response.ok) {
        // If the response is not ok (status code not in the range 200-299), throw an error
        return response.json().then(errorData => {
            throw new Error(errorData.message || 'Network response was not ok.');
        });
    }
    // Otherwise, parse the JSON response
    return response.json();
})
.then(data => {
    if (data) {
        alert('Animal added successfully!');
        form.reset(); // Reset form fields
        document.location.replace('/packroute')
    } else {
        alert('Error adding animal: ' + data.message);
    }
})
.catch(error => {
    console.error('Fetch error:', error);
    alert('There was an error with the request.');
});
    });


    // Handle Cancel button click
    cancelButton.addEventListener('click', function() {
        form.reset(); // Reset form fields
        window.location.href = '/packroute'; // Redirect to the animals list page or any other page
    });
});
</script>
